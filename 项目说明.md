# 重启人生 - 完整项目说明

## 项目概述

这是一个智能家居安全签到和紧急警报应用程序，包含完整的前后端系统。

## 项目结构

```
重启人生/
├── frontend/              # 前端React应用
│   ├── components/        # React组件
│   ├── services/          # API服务
│   └── ...
├── backend/               # 后端Node.js API
│   ├── src/
│   │   ├── db/           # 数据库
│   │   ├── models/       # 数据模型
│   │   ├── routes/       # API路由
│   │   └── services/     # 业务服务
│   └── ...
└── ...
```

## 快速开始

### 1. 启动后端服务

```bash
cd backend
npm install
npm run dev
```

后端服务将在 http://localhost:3001 启动

### 2. 启动前端应用

```bash
# 在项目根目录
npm install
npm run dev
```

前端应用将在 http://localhost:5173 启动

### 3. 配置环境变量

#### 后端配置 (backend/.env)
```env
PORT=3001
DATABASE_PATH=./data/database.db
GEMINI_API_KEY=your_gemini_api_key_here  # 可选
CORS_ORIGIN=http://localhost:5173
```

#### 前端配置 (.env)
```env
VITE_API_URL=http://localhost:3001/api
```

## 功能特性

### 1. 打卡功能
- 每日签到打卡
- 防止重复打卡
- 显示上次打卡时间
- 预计下次打卡时间

### 2. 统计功能
- 本周打卡统计（柱状图）
- 本周总计
- 连续打卡天数

### 3. 设置功能
- 邮件通知开关
- 短信通知开关
- 自动报警配置
- 邮箱设置

### 4. 联系人管理
- 添加紧急联系人（最多5个）
- 编辑联系人信息
- 删除联系人
- 联系人类型（手机/住宅）

### 5. AI问候
- 每日AI生成的问候语（使用Gemini API）

## 数据库表结构

### users
用户基本信息表

### checkins
打卡记录表，记录每次打卡的时间

### user_settings
用户设置表，存储通知和报警配置

### emergency_contacts
紧急联系人表，存储联系人信息

## API接口文档

### 打卡接口
- `POST /api/checkin` - 创建打卡
- `GET /api/checkin/stats` - 获取统计
- `GET /api/checkin/last` - 获取最后打卡
- `GET /api/checkin/today` - 检查今日打卡

### 设置接口
- `GET /api/settings` - 获取设置
- `PUT /api/settings` - 更新设置

### 联系人接口
- `GET /api/contacts` - 获取联系人列表
- `POST /api/contacts` - 创建联系人
- `PUT /api/contacts/:id` - 更新联系人
- `DELETE /api/contacts/:id` - 删除联系人

### 问候接口
- `GET /api/greeting` - 获取每日问候

## 技术栈

### 前端
- React 19
- TypeScript
- Vite
- React Router
- Recharts (图表)
- Tailwind CSS (样式)

### 后端
- Node.js
- Express
- TypeScript
- SQLite (better-sqlite3)
- Google Gemini AI (可选)

## 开发说明

### 数据库初始化
数据库会在首次启动后端服务时自动创建和初始化。

### 数据持久化
所有数据存储在SQLite数据库中，位于 `backend/data/database.db`

### CORS配置
后端已配置CORS，允许前端应用访问API。

## 注意事项

1. 首次运行需要安装依赖
2. 确保后端服务先启动
3. Gemini API Key是可选的，不配置也能正常运行（会使用默认问候语）
4. 数据库文件会自动创建，无需手动初始化
